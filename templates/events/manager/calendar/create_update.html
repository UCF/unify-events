{% extends 'events/manager/base.html' %}
{% load widget_tweaks %}

{% block alerts %}
    {% if form.non_field_errors %}
        <div class="row">
            <div class="span12">
                <div class="alert">
                    <strong>Error: </strong>
                    {{form.non_field_errors}}
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}

{% block content_title_icon %}
<i class="icon-plus" id="page-title-icon"></i>
{% endblock %}

{% block content_title %}
    {% if mode == 'create' %}
        <h2>Create a Calendar</h2>
    {% elif mode == 'update' %}
        <h2>Update {{calendar.name}} Calendar</h2>
    {% endif %}
{% endblock %}

{% block content_subheader_text %}
Use the form below to create a new calendar. Note that you can only 
own or be an editor on up to five (5) calendars at a time.
{% endblock %}

{% block content_body %}
    
    {% if mode == 'create' %}
    <form action="{% url calendar-create %}" method="post" id="calendar-create" class="form-horizontal">
    {% elif mode == 'update' %}
    <form action="{% url calendar-update %}" method="post" id="calendar-update" class="form-horizontal">
    {% endif %}
        <div class="control-group large">
           <label class="control-label" for="id_name">Calendar Name</label>
           <div class="controls">
           {{ form.name|add_class:"span5"|attr:"placeholder:Enter a calendar name..." }}
           </div>
        </div>
        <div class="control-group large">
           <label class="control-label" for="id_description">Description</label>
           <p class="label-desc">A brief blurb about your calendar and/or its events. Limit 140 characters.</p>
           <div class="controls">
           <!-- TODO: add textarea cols via view; django-widget-tweaks doesn't work with .as_textarea :( -->
           {{ form.description|add_class:"span5" }}
           </div>
        </div>
        {% for field in form.hidden_fields %}
            {{field}}
        {% endfor %}
        <div class="control-group large">
            <div class="controls">
                {% if mode == 'create' %}
                <button type="submit" class="btn btn-primary">Create Calendar</button>
                {% else %}
                    {% if mode == 'update' %}
                    <button class="btn btn-primary" type="submit">Update</button>
                    <a href="{% url calendar-delete calendar_id=calendar.id %}" class="btn btn-danger">Delete Calendar</a>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    </form>
{% endblock %}

{% block footer_scripts %}
    {{block.super}}
    <script type="text/javascript">
        $().ready(function() {
            $('#id_name')
                .keyup(function() {
                    $('#id_slug').val(sluggify($(this).val()));
                })
        });
    </script>
{% endblock %}