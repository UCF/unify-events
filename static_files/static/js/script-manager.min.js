!function(e,t){"use strict";"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):t(e.jQuery)}(this,function(e){"use strict";var t=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,i),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"==typeof this.options.autoSelect?this.options.autoSelect:!0,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.source=this.options.source,this.delay=this.options.delay,this.$menu=e(this.options.menu),this.$appendTo=this.options.appendTo?e(this.options.appendTo):null,this.shown=!1,this.listen(),this.showHintOnFocus="boolean"==typeof this.options.showHintOnFocus?this.options.showHintOnFocus:!1,this.afterSelect=this.options.afterSelect,this.addItem=!1};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").data("value");if(this.$element.data("active",e),this.autoSelect||e){var t=this.updater(e);this.$element.val(this.displayText(t)||t).change(),this.afterSelect(t)}return this.hide()},updater:function(e){return e},setSource:function(e){this.source=e},show:function(){var t,i=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return t="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight,(this.$appendTo?this.$menu.appendTo(this.$appendTo):this.$menu.insertAfter(this.$element)).css({top:i.top+i.height+t,left:i.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){if(this.query="undefined"!=typeof t&&null!==t?t:this.$element.val()||"",this.query.length<this.options.minLength)return this.shown?this.hide():this;var i=e.proxy(function(){e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(i,this.delay)},process:function(t){var i=this;return t=e.grep(t,function(e){return i.matcher(e)}),t=this.sorter(t),t.length||this.options.addItem?(t.length>0?this.$element.data("active",t[0]):this.$element.data("active",null),this.options.addItem&&t.push(this.options.addItem),"all"==this.options.items?this.render(t).show():this.render(t.slice(0,this.options.items)).show()):this.shown?this.hide():this},matcher:function(e){var t=this.displayText(e);return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){for(var t,i=[],a=[],s=[];t=e.shift();){var n=this.displayText(t);n.toLowerCase().indexOf(this.query.toLowerCase())?~n.indexOf(this.query)?a.push(t):s.push(t):i.push(t)}return i.concat(a,s)},highlighter:function(t){var i,a,s,n,o,r=e("<div></div>"),l=this.query,c=t.toLowerCase().indexOf(l.toLowerCase());if(i=l.length,0===i)return r.text(t).html();for(;c>-1;)a=t.substr(0,c),s=t.substr(c,i),n=t.substr(c+i),o=e("<strong></strong>").text(s),r.append(document.createTextNode(a)).append(o),t=n,c=t.toLowerCase().indexOf(l.toLowerCase());return r.append(document.createTextNode(t)).html()},render:function(t){var i=this,a=this,s=!1;return t=e(t).map(function(t,n){var o=a.displayText(n);return t=e(i.options.item).data("value",n),t.find("a").html(i.highlighter(o)),o==a.$element.val()&&(t.addClass("active"),a.$element.data("active",n),s=!0),t[0]}),this.autoSelect&&!s&&(t.first().addClass("active"),this.$element.data("active",t.first().data("value"))),this.$menu.html(t),this},displayText:function(e){return e.name||e},next:function(t){var i=this.$menu.find(".active").removeClass("active"),a=i.next();a.length||(a=e(this.$menu.find("li")[0])),a.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),i=t.prev();i.length||(i=this.$menu.find("li").last()),i.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.off("focus").off("blur").off("keypress").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove()},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t="function"==typeof this.$element[e]),t},move:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if(e.shiftKey)return;e.preventDefault(),this.prev();break;case 40:if(e.shiftKey)return;e.preventDefault(),this.next()}e.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.shown||40!=t.keyCode?this.move(t):this.lookup()},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused||(this.focused=!0,this.options.showHintOnFocus&&this.lookup(""))},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var i=e.fn.typeahead;e.fn.typeahead=function(i){var a=arguments;return"string"==typeof i&&"getActive"==i?this.data("active"):this.each(function(){var s=e(this),n=s.data("typeahead"),o="object"==typeof i&&i;n||s.data("typeahead",n=new t(this,o)),"string"==typeof i&&(a.length>1?n[i].apply(n,Array.prototype.slice.call(a,1)):n[i]())})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a href="#" role="option"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:e.noop,addItem:!1,delay:0},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=i,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var i=e(this);i.data("typeahead")||i.typeahead(i.data())})}),function(e){"object"==typeof exports&&exports&&"object"==typeof module&&module&&module.exports===exports?e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(e){var t=e[0];return t.offsetWidth>0&&t.offsetHeight>0}function a(t){if(t.minTime&&(t.minTime=w(t.minTime)),t.maxTime&&(t.maxTime=w(t.maxTime)),t.durationTime&&"function"!=typeof t.durationTime&&(t.durationTime=w(t.durationTime)),"now"==t.scrollDefault)t.scrollDefault=function(){return t.roundingFunction(w(new Date),t)};else if(t.scrollDefault&&"function"!=typeof t.scrollDefault){var i=t.scrollDefault;t.scrollDefault=function(){return t.roundingFunction(w(i),t)}}else t.minTime&&(t.scrollDefault=function(){return t.roundingFunction(t.minTime,t)});if("string"===e.type(t.timeFormat)&&t.timeFormat.match(/[gh]/)&&(t._twelveHourTime=!0),t.showOnFocus===!1&&-1!=t.showOn.indexOf("focus")&&t.showOn.splice(t.showOn.indexOf("focus"),1),t.disableTimeRanges.length>0){for(var a in t.disableTimeRanges)t.disableTimeRanges[a]=[w(t.disableTimeRanges[a][0]),w(t.disableTimeRanges[a][1])];t.disableTimeRanges=t.disableTimeRanges.sort(function(e,t){return e[0]-t[0]});for(var a=t.disableTimeRanges.length-1;a>0;a--)t.disableTimeRanges[a][0]<=t.disableTimeRanges[a-1][1]&&(t.disableTimeRanges[a-1]=[Math.min(t.disableTimeRanges[a][0],t.disableTimeRanges[a-1][0]),Math.max(t.disableTimeRanges[a][1],t.disableTimeRanges[a-1][1])],t.disableTimeRanges.splice(a,1))}return t}function s(t){var i=t.data("timepicker-settings"),a=t.data("timepicker-list");if(a&&a.length&&(a.remove(),t.data("timepicker-list",!1)),i.useSelect){a=e("<select />",{"class":"ui-timepicker-select"});var s=a}else{a=e("<ul />",{"class":"ui-timepicker-list"});var s=e("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});s.css({display:"none",position:"absolute"}).append(a)}if(i.noneOption)if(i.noneOption===!0&&(i.noneOption=i.useSelect?"Time...":"None"),e.isArray(i.noneOption)){for(var r in i.noneOption)if(parseInt(r,10)==r){var l=n(i.noneOption[r],i.useSelect);a.append(l)}}else{var l=n(i.noneOption,i.useSelect);a.append(l)}if(i.className&&s.addClass(i.className),(null!==i.minTime||null!==i.durationTime)&&i.showDuration){{"function"==typeof i.step?"function":i.step}s.addClass("ui-timepicker-with-duration"),s.addClass("ui-timepicker-step-"+i.step)}var h=i.minTime;"function"==typeof i.durationTime?h=w(i.durationTime()):null!==i.durationTime&&(h=i.durationTime);var u=null!==i.minTime?i.minTime:0,p=null!==i.maxTime?i.maxTime:u+b-1;u>p&&(p+=b),p===b-1&&"string"===e.type(i.timeFormat)&&i.show2400&&(p=b);var m=i.disableTimeRanges,v=0,D=m.length,T=i.step;"function"!=typeof T&&(T=function(){return i.step});for(var r=u,F=0;p>=r;F++,r+=60*T(F)){var _=r,x=k(_,i);if(i.useSelect){var $=e("<option />",{value:x});$.text(x)}else{var $=e("<li />");$.data("time",86400>=_?_:_%86400),$.text(x)}if((null!==i.minTime||null!==i.durationTime)&&i.showDuration){var M=y(r-h,i.step);if(i.useSelect)$.text($.text()+" ("+M+")");else{var S=e("<span />",{"class":"ui-timepicker-duration"});S.text(" ("+M+")"),$.append(S)}}D>v&&(_>=m[v][1]&&(v+=1),m[v]&&_>=m[v][0]&&_<m[v][1]&&(i.useSelect?$.prop("disabled",!0):$.addClass("ui-timepicker-disabled"))),a.append($)}if(s.data("timepicker-input",t),t.data("timepicker-list",s),i.useSelect)t.val()&&a.val(o(w(t.val()),i)),a.on("focus",function(){e(this).data("timepicker-input").trigger("showTimepicker")}),a.on("blur",function(){e(this).data("timepicker-input").trigger("hideTimepicker")}),a.on("change",function(){f(t,e(this).val(),"select")}),f(t,a.val(),"initial"),t.hide().after(a);else{var U=i.appendTo;"string"==typeof U?U=e(U):"function"==typeof U&&(U=U(t)),U.append(s),d(t,a),a.on("mousedown","li",function(i){t.off("focus.timepicker"),t.on("focus.timepicker-ie-hack",function(){t.off("focus.timepicker-ie-hack"),t.on("focus.timepicker",C.show)}),c(t)||t[0].focus(),a.find("li").removeClass("ui-timepicker-selected"),e(this).addClass("ui-timepicker-selected"),g(t)&&(t.trigger("hideTimepicker"),a.on("mouseup.timepicker","li",function(e){a.off("mouseup.timepicker"),s.hide()}))})}}function n(t,i){var a,s,n;return"object"==typeof t?(a=t.label,s=t.className,n=t.value):"string"==typeof t?a=t:e.error("Invalid noneOption value"),i?e("<option />",{value:n,"class":s,text:a}):e("<li />",{"class":s,text:a}).data("time",n)}function o(e,t){return e=t.roundingFunction(e,t),null!==e?k(e,t):void 0}function r(){return new Date(1970,1,1,0,0,0)}function l(t){var i=e(t.target),a=i.closest(".ui-timepicker-input");0===a.length&&0===i.closest(".ui-timepicker-wrapper").length&&(C.hide(),e(document).unbind(".ui-timepicker"),e(window).unbind(".ui-timepicker"))}function c(e){var t=e.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&t.disableTouchKeyboard}function h(t,i,a){if(!a&&0!==a)return!1;var s=t.data("timepicker-settings"),n=!1,a=s.roundingFunction(a,s);return i.find("li").each(function(t,i){var s=e(i);if("number"==typeof s.data("time"))return s.data("time")==a?(n=s,!1):void 0}),n}function d(e,t){t.find("li").removeClass("ui-timepicker-selected");var i=w(p(e),e.data("timepicker-settings"));if(null!==i){var a=h(e,t,i);if(a){var s=a.offset().top-t.offset().top;(s+a.outerHeight()>t.outerHeight()||0>s)&&t.scrollTop(t.scrollTop()+a.position().top-a.outerHeight()),a.addClass("ui-timepicker-selected")}}}function u(t,i){if(""!==this.value&&"timepicker"!=i){var a=e(this);if(!a.is(":focus")||t&&"change"==t.type){var s=a.data("timepicker-settings"),n=w(this.value,s);if(null===n)return void a.trigger("timeFormatError");var o=!1;null!==s.minTime&&n<s.minTime?o=!0:null!==s.maxTime&&n>s.maxTime&&(o=!0),e.each(s.disableTimeRanges,function(){return n>=this[0]&&n<this[1]?(o=!0,!1):void 0}),s.forceRoundTime&&(n=s.roundingFunction(n,s));var r=k(n,s);o?f(a,r,"error")&&a.trigger("timeRangeError"):f(a,r)}}}function p(e){return e.is("input")?e.val():e.data("ui-timepicker-value")}function f(e,t,i){if(e.is("input")){e.val(t);var a=e.data("timepicker-settings");a.useSelect&&"select"!=i&&"initial"!=i&&e.data("timepicker-list").val(o(w(t),a))}return e.data("ui-timepicker-value")!=t?(e.data("ui-timepicker-value",t),"select"==i?e.trigger("selectTime").trigger("changeTime").trigger("change","timepicker"):"error"!=i&&e.trigger("changeTime"),!0):(e.trigger("selectTime"),!1)}function m(i){var a=e(this),s=a.data("timepicker-list");if(!s||!t(s)){if(40!=i.keyCode)return!0;C.show.call(a.get(0)),s=a.data("timepicker-list"),c(a)||a.focus()}switch(i.keyCode){case 13:return g(a)&&C.hide.apply(this),i.preventDefault(),!1;case 38:var n=s.find(".ui-timepicker-selected");return n.length?n.is(":first-child")||(n.removeClass("ui-timepicker-selected"),n.prev().addClass("ui-timepicker-selected"),n.prev().position().top<n.outerHeight()&&s.scrollTop(s.scrollTop()-n.outerHeight())):(s.find("li").each(function(t,i){return e(i).position().top>0?(n=e(i),!1):void 0}),n.addClass("ui-timepicker-selected")),!1;case 40:return n=s.find(".ui-timepicker-selected"),0===n.length?(s.find("li").each(function(t,i){return e(i).position().top>0?(n=e(i),!1):void 0}),n.addClass("ui-timepicker-selected")):n.is(":last-child")||(n.removeClass("ui-timepicker-selected"),n.next().addClass("ui-timepicker-selected"),n.next().position().top+2*n.outerHeight()>s.outerHeight()&&s.scrollTop(s.scrollTop()+n.outerHeight())),!1;case 27:s.find("li").removeClass("ui-timepicker-selected"),C.hide();break;case 9:C.hide();break;default:return!0}}function v(i){var a=e(this),s=a.data("timepicker-list"),n=a.data("timepicker-settings");if(!s||!t(s)||n.disableTextInput)return!0;switch(i.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:n.typeaheadHighlight?d(a,s):s.hide()}}function g(e){var t=e.data("timepicker-settings"),i=e.data("timepicker-list"),a=null,s=i.find(".ui-timepicker-selected");return s.hasClass("ui-timepicker-disabled")?!1:(s.length&&(a=s.data("time")),null!==a&&("string"!=typeof a&&(a=k(a,t)),f(e,a,"select")),!0)}function y(e,t){e=Math.abs(e);var i,a,s=Math.round(e/60),n=[];return 60>s?n=[s,T.mins]:(i=Math.floor(s/60),a=s%60,30==t&&30==a&&(i+=T.decimal+5),n.push(i),n.push(1==i?T.hr:T.hrs),30!=t&&a&&(n.push(a),n.push(T.mins))),n.join(" ")}function k(t,i){if(null===t)return null;var a=new Date(D.valueOf()+1e3*t);if(isNaN(a.getTime()))return null;if("function"===e.type(i.timeFormat))return i.timeFormat(a);for(var s,n,o="",r=0;r<i.timeFormat.length;r++)switch(n=i.timeFormat.charAt(r)){case"a":o+=a.getHours()>11?T.pm:T.am;break;case"A":o+=a.getHours()>11?T.PM:T.AM;break;case"g":s=a.getHours()%12,o+=0===s?"12":s;break;case"G":s=a.getHours(),t===b&&(s=24),o+=s;break;case"h":s=a.getHours()%12,0!==s&&10>s&&(s="0"+s),o+=0===s?"12":s;break;case"H":s=a.getHours(),t===b&&(s=24),o+=s>9?s:"0"+s;break;case"i":var l=a.getMinutes();o+=l>9?l:"0"+l;break;case"s":t=a.getSeconds(),o+=t>9?t:"0"+t;break;case"\\":r++,o+=i.timeFormat.charAt(r);break;default:o+=n}return o}function w(e,t){if(""===e)return null;if(!e||e+0==e)return e;if("object"==typeof e)return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds();e=e.toLowerCase().replace(/[\s\.]/g,""),("a"==e.slice(-1)||"p"==e.slice(-1))&&(e+="m");var i="("+T.am.replace(".","")+"|"+T.pm.replace(".","")+"|"+T.AM.replace(".","")+"|"+T.PM.replace(".","")+")?",a=new RegExp("^"+i+"([0-2]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?"+i+"$"),s=e.match(a);if(!s)return null;var n=parseInt(1*s[2],10),o=s[1]||s[5],r=n;if(12>=n&&o){var l=o==T.pm||o==T.PM;r=12==n?l?12:0:n+(l?12:0)}var c=1*s[3]||0,h=1*s[4]||0,d=3600*r+60*c+h;if(!o&&t&&t._twelveHourTime&&t.scrollDefault){var u=d-t.scrollDefault();0>u&&u>=b/-2&&(d=(d+b/2)%b)}return d}var D=r(),b=86400,T={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},C={init:function(t){return this.each(function(){var n=e(this),o=[];for(var r in e.fn.timepicker.defaults)n.data(r)&&(o[r]=n.data(r));var l=e.extend({},e.fn.timepicker.defaults,o,t);if(l.lang&&(T=e.extend(T,l.lang)),l=a(l),n.data("timepicker-settings",l),n.addClass("ui-timepicker-input"),l.useSelect)s(n);else{if(n.prop("autocomplete","off"),l.showOn)for(i in l.showOn)n.on(l.showOn[i]+".timepicker",C.show);n.on("change.timepicker",u),n.on("keydown.timepicker",m),n.on("keyup.timepicker",v),l.disableTextInput&&n.on("keypress.timepicker",function(e){e.preventDefault()}),u.call(n.get(0))}})},show:function(i){var a=e(this),n=a.data("timepicker-settings");if(i&&i.preventDefault(),n.useSelect)return void a.data("timepicker-list").focus();c(a)&&a.blur();var o=a.data("timepicker-list");if(!a.prop("readonly")&&(o&&0!==o.length&&"function"!=typeof n.durationTime||(s(a),o=a.data("timepicker-list")),!t(o))){a.data("ui-timepicker-value",a.val()),d(a,o),C.hide(),o.show();var r={};r.left=n.orientation.match(/r/)?a.offset().left+a.outerWidth()-o.outerWidth()+parseInt(o.css("marginLeft").replace("px",""),10):a.offset().left+parseInt(o.css("marginLeft").replace("px",""),10);var u;u=n.orientation.match(/t/)?"t":n.orientation.match(/b/)?"b":a.offset().top+a.outerHeight(!0)+o.outerHeight()>e(window).height()+e(window).scrollTop()?"t":"b","t"==u?(o.addClass("ui-timepicker-positioned-top"),r.top=a.offset().top-o.outerHeight()+parseInt(o.css("marginTop").replace("px",""),10)):(o.removeClass("ui-timepicker-positioned-top"),r.top=a.offset().top+a.outerHeight()+parseInt(o.css("marginTop").replace("px",""),10)),o.offset(r);var f=o.find(".ui-timepicker-selected");if(f.length||(p(a)?f=h(a,o,w(p(a))):n.scrollDefault&&(f=h(a,o,n.scrollDefault()))),f&&f.length){var m=o.scrollTop()+f.position().top-f.outerHeight();o.scrollTop(m)}else o.scrollTop(0);return n.stopScrollPropagation&&e(document).on("wheel.ui-timepicker",".ui-timepicker-wrapper",function(t){t.preventDefault();var i=e(this).scrollTop();e(this).scrollTop(i+t.originalEvent.deltaY)}),e(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",l),e(window).on("resize.ui-timepicker",l),n.closeOnWindowScroll&&e(document).on("scroll.ui-timepicker",l),a.trigger("showTimepicker"),this}},hide:function(i){var a=e(this),s=a.data("timepicker-settings");return s&&s.useSelect&&a.blur(),e(".ui-timepicker-wrapper").each(function(){var i=e(this);if(t(i)){var a=i.data("timepicker-input"),s=a.data("timepicker-settings");s&&s.selectOnBlur&&g(a),i.hide(),a.trigger("hideTimepicker")}}),this},option:function(t,i){return this.each(function(){var n=e(this),o=n.data("timepicker-settings"),r=n.data("timepicker-list");if("object"==typeof t)o=e.extend(o,t);else if("string"==typeof t&&"undefined"!=typeof i)o[t]=i;else if("string"==typeof t)return o[t];o=a(o),n.data("timepicker-settings",o),r&&(r.remove(),n.data("timepicker-list",!1)),o.useSelect&&s(n)})},getSecondsFromMidnight:function(){return w(p(this))},getTime:function(e){var t=this,i=p(t);if(!i)return null;var a=w(i);if(null===a)return null;e||(e=new Date);var s=new Date(e);return s.setHours(a/3600),s.setMinutes(a%3600/60),s.setSeconds(a%60),s.setMilliseconds(0),s},setTime:function(e){var t=this,i=t.data("timepicker-settings");if(i.forceRoundTime)var a=o(w(e),i);else var a=k(w(e),i);return e&&null===a&&i.noneOption&&(a=e),f(t,a),t.data("timepicker-list")&&d(t,t.data("timepicker-list")),this},remove:function(){var e=this;if(e.hasClass("ui-timepicker-input")){var t=e.data("timepicker-settings");return e.removeAttr("autocomplete","off"),e.removeClass("ui-timepicker-input"),e.removeData("timepicker-settings"),e.off(".timepicker"),e.data("timepicker-list")&&e.data("timepicker-list").remove(),t.useSelect&&e.show(),e.removeData("timepicker-list"),this}}};e.fn.timepicker=function(t){return this.length?C[t]?this.hasClass("ui-timepicker-input")?C[t].apply(this,Array.prototype.slice.call(arguments,1)):this:"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.timepicker"):C.init.apply(this,arguments):this},e.fn.timepicker.defaults={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:!1,showOnFocus:!0,showOn:["click","focus"],timeFormat:"g:ia",scrollDefault:null,selectOnBlur:!1,disableTextInput:!1,disableTouchKeyboard:!1,forceRoundTime:!1,roundingFunction:function(e,t){if(null===e)return null;var i=e%(60*t.step);return i>=30*t.step?e+=60*t.step-i:e-=i,e},appendTo:"body",orientation:"l",disableTimeRanges:[],closeOnWindowScroll:!1,typeaheadHighlight:!0,noneOption:!1,show2400:!1,stopScrollPropagation:!1}}),function(e,t){function i(){return new Date(Date.UTC.apply(Date,arguments))}function a(){var e=new Date;return i(e.getFullYear(),e.getMonth(),e.getDate())}function s(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}function n(e){return function(){return this[e].apply(this,arguments)}}function o(t,i){function a(e,t){return t.toLowerCase()}var s,n=e(t).data(),o={},r=new RegExp("^"+i.toLowerCase()+"([A-Z])");i=new RegExp("^"+i.toLowerCase());for(var l in n)i.test(l)&&(s=l.replace(r,a),o[s]=n[l]);return o}function r(t){var i={};if(m[t]||(t=t.split("-")[0],m[t])){var a=m[t];return e.each(f,function(e,t){t in a&&(i[t]=a[t])}),i}}var l=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){for(var t=e&&e.valueOf(),i=0,a=this.length;a>i;i++)if(this[i].valueOf()===t)return i;return-1},remove:function(e){this.splice(e,1)},replace:function(t){t&&(e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.length=0},copy:function(){var e=new l;return e.replace(this),e}};return function(){var i=[];return i.push.apply(i,arguments),e.extend(i,t),i}}(),c=function(t,i){this._process_options(i),this.dates=new l,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=e(v.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot .today, tfoot .clear").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.setDatesDisabled(this.o.datesDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};c.prototype={constructor:c,_process_options:function(s){this._o=e.extend({},this._o,s);var n=this.o=e.extend({},this._o),o=n.language;switch(m[o]||(o=o.split("-")[0],m[o]||(o=p.language)),n.language=o,n.startView){case 2:case"decade":n.startView=2;break;case 1:case"year":n.startView=1;break;default:n.startView=0}switch(n.minViewMode){case 1:case"months":n.minViewMode=1;break;case 2:case"years":n.minViewMode=2;break;default:n.minViewMode=0}n.startView=Math.max(n.startView,n.minViewMode),n.multidate!==!0&&(n.multidate=Number(n.multidate)||!1,n.multidate!==!1&&(n.multidate=Math.max(0,n.multidate))),n.multidateSeparator=String(n.multidateSeparator),n.weekStart%=7,n.weekEnd=(n.weekStart+6)%7;var r=v.parseFormat(n.format);if(n.startDate!==-(1/0)&&(n.startDate=n.startDate?n.startDate instanceof Date?this._local_to_utc(this._zero_time(n.startDate)):v.parseDate(n.startDate,r,n.language):-(1/0)),n.endDate!==1/0&&(n.endDate=n.endDate?n.endDate instanceof Date?this._local_to_utc(this._zero_time(n.endDate)):v.parseDate(n.endDate,r,n.language):1/0),n.daysOfWeekDisabled=n.daysOfWeekDisabled||[],e.isArray(n.daysOfWeekDisabled)||(n.daysOfWeekDisabled=n.daysOfWeekDisabled.split(/[,\s]*/)),n.daysOfWeekDisabled=e.map(n.daysOfWeekDisabled,function(e){return parseInt(e,10)}),n.datesDisabled=n.datesDisabled||[],!e.isArray(n.datesDisabled)){var l=[];l.push(v.parseDate(n.datesDisabled,r,n.language)),n.datesDisabled=l}n.datesDisabled=e.map(n.datesDisabled,function(e){return v.parseDate(e,r,n.language)});var c=String(n.orientation).toLowerCase().split(/\s+/g),h=n.orientation.toLowerCase();if(c=e.grep(c,function(e){return/^auto|left|right|top|bottom$/.test(e)}),n.orientation={x:"auto",y:"auto"},h&&"auto"!==h)if(1===c.length)switch(c[0]){case"top":case"bottom":n.orientation.y=c[0];break;case"left":case"right":n.orientation.x=c[0]}else h=e.grep(c,function(e){return/^left|right$/.test(e)}),n.orientation.x=h[0]||"auto",h=e.grep(c,function(e){return/^top|bottom$/.test(e)}),n.orientation.y=h[0]||"auto";else;if(n.defaultViewDate){var d=n.defaultViewDate.year||(new Date).getFullYear(),u=n.defaultViewDate.month||0,f=n.defaultViewDate.day||1;n.defaultViewDate=i(d,u,f)}else n.defaultViewDate=a();n.showOnFocus=n.showOnFocus!==t?n.showOnFocus:!0},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var i,a,s,n=0;n<e.length;n++)i=e[n][0],2===e[n].length?(a=t,s=e[n][1]):3===e[n].length&&(a=e[n][1],s=e[n][2]),i.on(s,a)},_unapplyEvents:function(e){for(var i,a,s,n=0;n<e.length;n++)i=e[n][0],2===e[n].length?(s=t,a=e[n][1]):3===e[n].length&&(s=e[n][1],a=e[n][2]),i.off(a,s)},_buildEvents:function(){var t={keyup:e.proxy(function(t){-1===e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:e.proxy(this.keydown,this)};this.o.showOnFocus===!0&&(t.focus=e.proxy(this.show,this)),this.isInput?this._events=[[this.element,t]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),t],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,i){var a=i||this.dates.get(-1),s=this._utc_to_local(a);this.element.trigger({type:t,date:s,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){0===arguments.length?(e=this.dates.length-1,t=this.o.format):"string"==typeof e&&(t=e,e=this.dates.length-1),t=t||this.o.format;var i=this.dates.get(e);return v.formatDate(i,t,this.o.language)},this)})},show:function(){return this.element.attr("readonly")&&this.o.enableOnReadonly===!1?void 0:(this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&e(this.element).blur(),this)},hide:function(){return this.isInline?this:this.picker.is(":visible")?(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"),this):this},remove:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},_utc_to_local:function(e){return e&&new Date(e.getTime()+6e4*e.getTimezoneOffset())},_local_to_utc:function(e){return e&&new Date(e.getTime()-6e4*e.getTimezoneOffset())},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var e=this.dates.get(-1);return"undefined"!=typeof e?new Date(e):null},clearDates:function(){var e;this.isInput?e=this.element:this.component&&(e=this.element.find("input")),e&&e.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,t),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,e.map(t,this._utc_to_local)),this._trigger("changeDate"),this.setValue(),this},setDate:n("setDates"),setUTCDate:n("setUTCDates"),setValue:function(){var e=this.getFormattedDate();return this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change(),this},getFormattedDate:function(i){i===t&&(i=this.o.format);var a=this.o.language;return e.map(this.dates,function(e){return v.formatDate(e,i,a)}).join(this.o.multidateSeparator)},setStartDate:function(e){return this._process_options({startDate:e}),this.update(),this.updateNavArrows(),this},setEndDate:function(e){return this._process_options({endDate:e}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(e){return this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows(),this},setDatesDisabled:function(e){this._process_options({datesDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return this;var t=this.picker.outerWidth(),i=this.picker.outerHeight(),a=10,s=e(this.o.container).width(),n=e(this.o.container).height(),o=e(this.o.container).scrollTop(),r=e(this.o.container).offset(),l=[];this.element.parents().each(function(){var t=e(this).css("z-index");"auto"!==t&&0!==t&&l.push(parseInt(t))});var c=Math.max.apply(Math,l)+10,h=this.component?this.component.parent().offset():this.element.offset(),d=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),u=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),p=h.left-r.left,f=h.top-r.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(p-=t-u)):h.left<0?(this.picker.addClass("datepicker-orient-left"),p-=h.left-a):p+t>s?(this.picker.addClass("datepicker-orient-right"),p=h.left+u-t):this.picker.addClass("datepicker-orient-left");var m,v,g=this.o.orientation.y;if("auto"===g&&(m=-o+f-i,
v=o+n-(f+d+i),g=Math.max(m,v)===v?"top":"bottom"),this.picker.addClass("datepicker-orient-"+g),"top"===g?f+=d:f-=i+parseInt(this.picker.css("padding-top")),this.o.rtl){var y=s-(p+u);this.picker.css({top:f,right:y,zIndex:c})}else this.picker.css({top:f,left:p,zIndex:c});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var t=this.dates.copy(),i=[],a=!1;return arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),i.push(t)},this)),a=!0):(i=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),i=i&&this.o.multidate?i.split(this.o.multidateSeparator):[i],delete this.element.data().date),i=e.map(i,e.proxy(function(e){return v.parseDate(e,this.o.format,this.o.language)},this)),i=e.grep(i,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(i),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),a?this.setValue():i.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill(),this},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){this.picker.find(".datepicker-days thead tr:first-child .datepicker-switch").attr("colspan",function(e,t){return parseInt(t)+1});var i='<th class="cw">&#160;</th>';t+=i}for(;e<this.o.weekStart+7;)t+='<th class="dow">'+m[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;12>t;)e+='<span class="month">'+m[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=e.map(t,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var i=[],a=this.viewDate.getUTCFullYear(),n=this.viewDate.getUTCMonth(),o=new Date;return t.getUTCFullYear()<a||t.getUTCFullYear()===a&&t.getUTCMonth()<n?i.push("old"):(t.getUTCFullYear()>a||t.getUTCFullYear()===a&&t.getUTCMonth()>n)&&i.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&i.push("focused"),this.o.todayHighlight&&t.getUTCFullYear()===o.getFullYear()&&t.getUTCMonth()===o.getMonth()&&t.getUTCDate()===o.getDate()&&i.push("today"),-1!==this.dates.contains(t)&&i.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled))&&i.push("disabled"),this.o.datesDisabled.length>0&&e.grep(this.o.datesDisabled,function(e){return s(t,e)}).length>0&&i.push("disabled","disabled-date"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&i.push("range"),-1!==e.inArray(t.valueOf(),this.range)&&i.push("selected")),i},fill:function(){var a,s=new Date(this.viewDate),n=s.getUTCFullYear(),o=s.getUTCMonth(),r=this.o.startDate!==-(1/0)?this.o.startDate.getUTCFullYear():-(1/0),l=this.o.startDate!==-(1/0)?this.o.startDate.getUTCMonth():-(1/0),c=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,h=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,d=m[this.o.language].today||m.en.today||"",u=m[this.o.language].clear||m.en.clear||"";if(!isNaN(n)&&!isNaN(o)){this.picker.find(".datepicker-days thead .datepicker-switch").text(m[this.o.language].months[o]+" "+n),this.picker.find("tfoot .today").text(d).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot .clear").text(u).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var p=i(n,o-1,28),f=v.getDaysInMonth(p.getUTCFullYear(),p.getUTCMonth());p.setUTCDate(f),p.setUTCDate(f-(p.getUTCDay()-this.o.weekStart+7)%7);var g=new Date(p);g.setUTCDate(g.getUTCDate()+42),g=g.valueOf();for(var y,k=[];p.valueOf()<g;){if(p.getUTCDay()===this.o.weekStart&&(k.push("<tr>"),this.o.calendarWeeks)){var w=new Date(+p+(this.o.weekStart-p.getUTCDay()-7)%7*864e5),D=new Date(Number(w)+(11-w.getUTCDay())%7*864e5),b=new Date(Number(b=i(D.getUTCFullYear(),0,1))+(11-b.getUTCDay())%7*864e5),T=(D-b)/864e5/7+1;k.push('<td class="cw">'+T+"</td>")}if(y=this.getClassNames(p),y.push("day"),this.o.beforeShowDay!==e.noop){var C=this.o.beforeShowDay(this._utc_to_local(p));C===t?C={}:"boolean"==typeof C?C={enabled:C}:"string"==typeof C&&(C={classes:C}),C.enabled===!1&&y.push("disabled"),C.classes&&(y=y.concat(C.classes.split(/\s+/))),C.tooltip&&(a=C.tooltip)}y=e.unique(y),k.push('<td class="'+y.join(" ")+'"'+(a?' title="'+a+'"':"")+">"+p.getUTCDate()+"</td>"),a=null,p.getUTCDay()===this.o.weekEnd&&k.push("</tr>"),p.setUTCDate(p.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(k.join(""));var F=this.picker.find(".datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("active");if(e.each(this.dates,function(e,t){t.getUTCFullYear()===n&&F.eq(t.getUTCMonth()).addClass("active")}),(r>n||n>c)&&F.addClass("disabled"),n===r&&F.slice(0,l).addClass("disabled"),n===c&&F.slice(h+1).addClass("disabled"),this.o.beforeShowMonth!==e.noop){var _=this;e.each(F,function(t,i){if(!e(i).hasClass("disabled")){var a=new Date(n,t,1),s=_.o.beforeShowMonth(a);s===!1&&e(i).addClass("disabled")}})}k="",n=10*parseInt(n/10,10);var x=this.picker.find(".datepicker-years").find("th:eq(1)").text(n+"-"+(n+9)).end().find("td");n-=1;for(var $,M=e.map(this.dates,function(e){return e.getUTCFullYear()}),S=-1;11>S;S++)$=["year"],-1===S?$.push("old"):10===S&&$.push("new"),-1!==e.inArray(n,M)&&$.push("active"),(r>n||n>c)&&$.push("disabled"),k+='<span class="'+$.join(" ")+'">'+n+"</span>",n+=1;x.html(k)}},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth();switch(this.viewMode){case 0:this.picker.find(".prev").css(this.o.startDate!==-(1/0)&&t<=this.o.startDate.getUTCFullYear()&&i<=this.o.startDate.getUTCMonth()?{visibility:"hidden"}:{visibility:"visible"}),this.picker.find(".next").css(this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()&&i>=this.o.endDate.getUTCMonth()?{visibility:"hidden"}:{visibility:"visible"});break;case 1:case 2:this.picker.find(".prev").css(this.o.startDate!==-(1/0)&&t<=this.o.startDate.getUTCFullYear()?{visibility:"hidden"}:{visibility:"visible"}),this.picker.find(".next").css(this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()?{visibility:"hidden"}:{visibility:"visible"})}}},click:function(t){t.preventDefault();var a,s,n,o=e(t.target).closest("span, td, th");if(1===o.length)switch(o[0].nodeName.toLowerCase()){case"th":switch(o[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var r=v.modes[this.viewMode].navStep*("prev"===o[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,r),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,r),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var l=new Date;l=i(l.getFullYear(),l.getMonth(),l.getDate(),0,0,0),this.showMode(-2);var c="linked"===this.o.todayBtn?null:"view";this._setDate(l,c);break;case"clear":this.clearDates()}break;case"span":o.hasClass("disabled")||(this.viewDate.setUTCDate(1),o.hasClass("month")?(n=1,s=o.parent().find("span").index(o),a=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(i(a,s,n))):(n=1,s=0,a=parseInt(o.text(),10)||0,this.viewDate.setUTCFullYear(a),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(i(a,s,n))),this.showMode(-1),this.fill());break;case"td":o.hasClass("day")&&!o.hasClass("disabled")&&(n=parseInt(o.text(),10)||1,a=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),o.hasClass("old")?0===s?(s=11,a-=1):s-=1:o.hasClass("new")&&(11===s?(s=0,a+=1):s+=1),this._setDate(i(a,s,n)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);if(e||this.dates.clear(),-1!==t?(this.o.multidate===!0||this.o.multidate>1||this.o.toggleActive)&&this.dates.remove(t):this.o.multidate===!1?(this.dates.clear(),this.dates.push(e)):this.dates.push(e),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(e,t){t&&"date"!==t||this._toggle_multidate(e&&new Date(e)),t&&"view"!==t||(this.viewDate=e&&new Date(e)),this.fill(),this.setValue(),t&&"view"===t||this._trigger("changeDate");var i;this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&i.change(),!this.o.autoclose||t&&"date"!==t||this.hide()},moveMonth:function(e,i){if(!e)return t;if(!i)return e;var a,s,n=new Date(e.valueOf()),o=n.getUTCDate(),r=n.getUTCMonth(),l=Math.abs(i);if(i=i>0?1:-1,1===l)s=-1===i?function(){return n.getUTCMonth()===r}:function(){return n.getUTCMonth()!==a},a=r+i,n.setUTCMonth(a),(0>a||a>11)&&(a=(a+12)%12);else{for(var c=0;l>c;c++)n=this.moveMonth(n,i);a=n.getUTCMonth(),n.setUTCDate(o),s=function(){return a!==n.getUTCMonth()}}for(;s();)n.setUTCDate(--o),n.setUTCMonth(a);return n},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(!this.picker.is(":visible"))return void(27===e.keyCode&&this.show());var t,i,s,n=!1,o=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;t=37===e.keyCode?-1:1,e.ctrlKey?(i=this.moveYear(this.dates.get(-1)||a(),t),s=this.moveYear(o,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(i=this.moveMonth(this.dates.get(-1)||a(),t),s=this.moveMonth(o,t),this._trigger("changeMonth",this.viewDate)):(i=new Date(this.dates.get(-1)||a()),i.setUTCDate(i.getUTCDate()+t),s=new Date(o),s.setUTCDate(o.getUTCDate()+t)),this.dateWithinRange(s)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;t=38===e.keyCode?-1:1,e.ctrlKey?(i=this.moveYear(this.dates.get(-1)||a(),t),s=this.moveYear(o,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(i=this.moveMonth(this.dates.get(-1)||a(),t),s=this.moveMonth(o,t),this._trigger("changeMonth",this.viewDate)):(i=new Date(this.dates.get(-1)||a()),i.setUTCDate(i.getUTCDate()+7*t),s=new Date(o),s.setUTCDate(o.getUTCDate()+7*t)),this.dateWithinRange(s)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:o=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(o),n=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(n){this._trigger(this.dates.length?"changeDate":"clearDate");var r;this.isInput?r=this.element:this.component&&(r=this.element.find("input")),r&&r.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.children("div").hide().filter(".datepicker-"+v.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var h=function(t,i){this.element=e(t),this.inputs=e.map(i.inputs,function(e){return e.jquery?e[0]:e}),delete i.inputs,u.call(e(this.inputs),i).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};h.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,i){i.setRange(t)})},dateUpdated:function(t){if(!this.updating){this.updating=!0;var i=e(t.target).data("datepicker"),a=i.getUTCDate(),s=e.inArray(t.target,this.inputs),n=s-1,o=s+1,r=this.inputs.length;if(-1!==s){if(e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(a)}),a<this.dates[n])for(;n>=0&&a<this.dates[n];)this.pickers[n--].setUTCDate(a);else if(a>this.dates[o])for(;r>o&&a>this.dates[o];)this.pickers[o++].setUTCDate(a);this.updateDates(),delete this.updating}}},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var d=e.fn.datepicker,u=function(i){var a=Array.apply(null,arguments);a.shift();var s;return this.each(function(){var n=e(this),l=n.data("datepicker"),d="object"==typeof i&&i;if(!l){var u=o(this,"date"),f=e.extend({},p,u,d),m=r(f.language),v=e.extend({},p,m,u,d);if(n.hasClass("input-daterange")||v.inputs){var g={inputs:v.inputs||n.find("input").toArray()};n.data("datepicker",l=new h(this,e.extend(v,g)))}else n.data("datepicker",l=new c(this,v))}return"string"==typeof i&&"function"==typeof l[i]&&(s=l[i].apply(l,a),s!==t)?!1:void 0}),s!==t?s:this};e.fn.datepicker=u;var p=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,beforeShowMonth:e.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-(1/0),startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,container:"body"},f=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=c;var m=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},v={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,v.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\x00").split("\x00"),i=e.match(this.validParts);if(!t||!t.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:t,parts:i}},parseDate:function(a,s,n){function o(){var e=this.slice(0,u[h].length),t=u[h].slice(0,e.length);return e.toLowerCase()===t.toLowerCase()}if(!a)return t;if(a instanceof Date)return a;"string"==typeof s&&(s=v.parseFormat(s));var r,l,h,d=/([\-+]\d+)([dmwy])/,u=a.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(a)){for(a=new Date,h=0;h<u.length;h++)switch(r=d.exec(u[h]),l=parseInt(r[1]),r[2]){case"d":a.setUTCDate(a.getUTCDate()+l);break;case"m":a=c.prototype.moveMonth.call(c.prototype,a,l);break;case"w":a.setUTCDate(a.getUTCDate()+7*l);break;case"y":a=c.prototype.moveYear.call(c.prototype,a,l)}return i(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),0,0,0)}u=a&&a.match(this.nonpunctuation)||[],a=new Date;var p,f,g={},y=["yyyy","yy","M","MM","m","mm","d","dd"],k={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;for(t-=1;0>t;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!==t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};k.M=k.MM=k.mm=k.m,k.dd=k.d,a=i(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);var w=s.parts.slice();if(u.length!==w.length&&(w=e(w).filter(function(t,i){return-1!==e.inArray(i,y)}).toArray()),u.length===w.length){var D;for(h=0,D=w.length;D>h;h++){if(p=parseInt(u[h],10),r=w[h],isNaN(p))switch(r){case"MM":f=e(m[n].months).filter(o),p=e.inArray(f[0],m[n].months)+1;break;case"M":f=e(m[n].monthsShort).filter(o),p=e.inArray(f[0],m[n].monthsShort)+1}g[r]=p}var b,T;for(h=0;h<y.length;h++)T=y[h],T in g&&!isNaN(g[T])&&(b=new Date(a),k[T](b,g[T]),isNaN(b)||(a=b))}return a},formatDate:function(t,i,a){if(!t)return"";"string"==typeof i&&(i=v.parseFormat(i));var s={d:t.getUTCDate(),D:m[a].daysShort[t.getUTCDay()],DD:m[a].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:m[a].monthsShort[t.getUTCMonth()],MM:m[a].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};s.dd=(s.d<10?"0":"")+s.d,s.mm=(s.m<10?"0":"")+s.m,t=[];for(var n=e.extend([],i.separators),o=0,r=i.parts.length;r>=o;o++)n.length&&t.push(n.shift()),t.push(s[i.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th class="prev">&#171;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&#187;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};v.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+v.headTemplate+"<tbody></tbody>"+v.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table></div></div>",e.fn.datepicker.DPGlobal=v,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=d,this},e.fn.datepicker.version="1.4.0",e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var i=e(this);i.data("datepicker")||(t.preventDefault(),u.call(i,"show"))}),e(function(){u.call(e('[data-provide="datepicker-inline"]'))})}(window.jQuery);var bulkSelectAll=function(){$("#bulk-select-all").click(function(){var e=$(this),t=$(".field-bulk-select input");t.prop("checked",e.is(":checked"))})},bulkActionSubmit=function(){var e=$("#bulk-action_0, #bulk-action_1");e.removeAttr("onchange"),$("#bulk-action_0, #bulk-action_1").change(function(){var e=this.form,t=$(this),i=t.find("option:selected"),a=$('input:checkbox:checked[name="object_ids"]'),s=!1;if(i.attr("value")&&"empty"!==i.attr("value")&&a.length)if("delete"===i.val())if(a.each(function(){var e=$(this);return parseInt(e.attr("data-event-instance-count"))>1?(s=!0,!1):void 0}),s){var n=$("#bulk-event-delete-modal");n.find("#bulk-event-delete-btn").click(function(){e.submit()}),n.modal()}else e.submit();else e.submit()})},toggleEventListRecurrences=function(){$(".recurrences-toggle").click(function(e){e.preventDefault(),$(this).next(".recurrences").slideToggle()})},toggleModalMergeObject=function(){var e=$("#object-merge-modal");$(".category-merge, .tag-merge, .location-merge").click(function(t){t.preventDefault();var i=$(this).attr("data-object-title"),a=$(this).attr("data-object-pk"),s=$(this).attr("href"),n="";n=$(this).hasClass("category-merge")?"category":"tag",e.find("#new-object-select option").each(function(){$(this).text()===i&&$(this).val()===a?$(this).prop("disabled",!0):$(this).prop("disabled",!1)}),e.find("span.object-type").text(n).end().find("h2 span.alt").text(i).end().find(".modal-footer a.btn-primary").attr("href",s).end().modal("show")});var t=e.find(".modal-footer a.btn:first-child");t.click(function(){var e=$("#new-object-select").val(),i=t.attr("href");""!==e&&(i=i.replace(/merge\/[A-Za-z0-9]+$/,"merge/"+e),t.attr("href",i))})},calendarOwnershipModal=function(){if($("#calendar-reassign-ownership")){var e=$("#calendar-reassign-ownership"),t=e.find(".modal-footer a.btn:first-child");t.click(function(){var e=$("#new-owner-select").val(),i=t.attr("href");""!==e&&(i=i.replace(/user\/[A-Za-z0-9]+$/,"user/"+e),t.attr("href",i))})}},toggleModalUserDemote=function(){var e=$("#user-demote-modal");$(".demote-self").click(function(t){t.preventDefault();var i=$(this).attr("data-user-name"),a=$(this).attr("href");e.find("h2 span.alt").text(i).end().find(".modal-footer a.btn-danger").attr("href",a).end().modal("show")});var t=e.find(".modal-footer a.btn:first-child");t.click(function(){var e=$("#new-object-select").val(),i=t.attr("href");""!==e&&(i=i.replace(/merge\/[A-Za-z0-9]+$/,"merge/"+e),t.attr("href",i))})},fallbackDtpOnClick=function(e){var t=e.siblings("input");t.is(":focus")||t.focus()},initiateDatePickers=function(e){e.each(function(){var e=$(this);e.parent().hasClass("bootstrap-datepicker")===!1&&e.addClass("form-control").wrap('<div class="bootstrap-dtp bootstrap-datepicker" />').parent().append('<i class="fa fa-calendar" />');var t=e.parent().parent(),i=t.siblings().find("."+e.attr("class"));e.datepicker({format:"mm/dd/yyyy",autoclose:!0,todayHighlight:!0,startDate:EARLIEST_VALID_DATE,endDate:LATEST_VALID_DATE}).on("changeDate",function(e){i.length&&t.hasClass("start")?i.datepicker("setStartDate",e.date):i.length&&t.hasClass("end")&&i.datepicker("setEndDate",e.date)}),t.find("i").on("click",function(){fallbackDtpOnClick($(this))})}).removeClass("placeholder").placeholder()},initiateTimePickers=function(e){e.each(function(){var e=$(this);e.parent().hasClass("bootstrap-timepicker")===!1&&e.addClass("form-control").wrap('<div class="bootstrap-dtp bootstrap-timepicker" />').parent().append('<i class="fa fa-clock-o" />');var t=e.parent().parent();t.find("i").on("click",function(){fallbackDtpOnClick($(this))})}).timepicker({scrollDefaultNow:!0,timeFormat:"h:i A",step:15}).removeClass("placeholder").placeholder()},initiateWysiwyg=function(e){e.wysihtml5({"font-styles":!1,emphasis:!0,lists:!0,html:!1,link:!0,image:!1,color:!1,size:"md",events:{load:function(){$("ul.wysihtml5-toolbar").find('li a[data-wysihtml5-command="createLink"]').html('<span class="fa fa-link"></span>').end().find("li.dropdown a").attr("tabindex","-1").end().find("span.glyphicon-list").attr("class","fa fa-list-ul").end().find("span.glyphicon-th-list").attr("class","fa fa-list-ol").end().find('li a[data-wysihtml5-command="Outdent"]').remove().end().find('li a[data-wysihtml5-command="Indent"]').remove().end().find('li a[data-wysihtml5-command="bold"]').html('<span class="fa fa-bold"></span>').end().find('li a[data-wysihtml5-command="italic"]').html('<span class="fa fa-italic"></span>').end().find('li a[data-wysihtml5-command="underline"]').html('<span class="fa fa-underline"></span>'),$(document.activeElement).blur()}}})},initiateDisabledWysiwyg=function(e){e.wysihtml5({"font-styles":!1,emphasis:!1,lists:!1,html:!1,link:!1,image:!1,color:!1,events:{load:function(){$(document.activeElement).blur()}}})},initiateReReviewCopy=function(){$("#copy_title").click(function(e){e.preventDefault(),$("#"+$(this).attr("data-copy-to")).val($("#new_title").val())}),$("#copy_description").click(function(e){e.preventDefault(),$("#"+$(this).attr("data-copy-to")).data("wysihtml5").editor.setValue($("#new_description").val())})},selectFieldAutocomplete=function(e,t){this.autocompleteField=e,this.dataField=t,this.form=t.parents("form"),this.searchableTerms=[],this.mappedData={},this.selection=null,this.setupForm=function(){},this.onFormSubmission=function(){var e=this;e.form.on("submit",function(){return e.autocompleteField.is(":focus")?!1:void 0})},this.checkEmptyValues=function(){var e=this;e.autocompleteField.on("keydown",function(t){e.autocompleteField.val()||"keydown"!==t.type||8!==t.keyCode&&46!==t.keyCode||(e.autocompleteField.trigger("change"),e.dataField.is("select")&&(e.dataField.children("option:selected").removeAttr("selected"),e.dataField.children("option:selected").prop("selected",!1)),e.dataField.val(""))})},this.setSearchTerms=function(){var e=this;e.dataField.is("select")&&$.each(e.dataField.children("option:not([disabled])"),function(){var t=$(this),i=t.val(),a=t.text();$.trim(a).length<1&&(a=i+" (name n/a)"),e.mappedData[a]=i,e.searchableTerms.push(a)})},this.typeaheadSource=function(e,t){var i=this;return t(i.searchableTerms)},this.typeaheadMatcher=function(e,t){return-1!==e.toLowerCase().indexOf(t.trim().toLowerCase())?!0:void 0},this.typeaheadUpdater=function(e){var t=this;return t.selection=t.mappedData[e],t.dataField.val(t.selection),t.dataField.is("select")&&t.dataField.children('option[value="'+t.selection+'"]').attr("selected",!0).prop("selected",!0),e},this.init=function(){var e=this;e.setupForm(),e.onFormSubmission(),e.checkEmptyValues(),e.setSearchTerms(),e.autocompleteField.typeahead({items:10,minLength:2,source:function(t,i){e.typeaheadSource(t,i)},matcher:function(t){var i=this.query;return e.typeaheadMatcher(t,i)},updater:function(t){return t=e.typeaheadUpdater(t)}})}},userSearchTypeahead=function(){var e=$("#id_add_user"),t=$("#id_username_d"),i=$("#id_role"),a=t.parents("form"),s=a.find("button"),n=new selectFieldAutocomplete(e,t);n.roleField=i,n.addBtn=s,n.setupForm=function(){var e=this;e.dataField.hide(),e.autocompleteField.show(),$('label[for="'+e.dataField.attr("id")+'"]').attr("for",e.autocompleteField.attr("id"));var t=function(e){e.preventDefault()},i=function(){if(""!==e.autocompleteField.val()&&e.dataField.val()&&""!==e.roleField.val()&&e.autocompleteField.val()!==e.autocompleteField.attr("placeholder")){var i=e.dataField.children("option").selected||e.dataField.children('option[selected="selected"]');"undefined"!=typeof i&&i.length>0&&i.text()===e.autocompleteField.val()?e.addBtn.removeClass("disabled").unbind("click",t):e.addBtn.addClass("disabled").bind("click",t)}else e.addBtn.addClass("disabled").bind("click",t)};i(),$([e.autocompleteField,e.dataField,e.roleField]).each(function(){$(this).on("change",function(){i()})})},n.onFormSubmission=function(){var e=this;e.form.on("submit",function(){if(e.autocompleteField.is(":focus"))return!1;if(e.form.find("button").hasClass("disabled")===!1){var t=e.form.attr("action"),i=e.dataField.children("option:selected").val(),a=e.roleField.val();t=t.replace("/username/role","/"+i+"/"+a),e.form.attr("action",t)}})},n.init()},eventLocationsSearch=function(e){e.length>0&&e.each(function(){var e=$(this),t=e.attr("id")+"-autocomplete",i=$('<input type="text" id="'+t+'" class="form-control location-autocomplete search-query" autocomplete="off" placeholder="Type a location name..." />'),a=e.parent(".location-search").parent(".row"),s=a.find(".location-selected-title"),n=a.find(".location-selected-room"),o=a.find(".location-selected-url"),r=a.find(".location-new-form"),l=new selectFieldAutocomplete(i,e);l.addBtn=$('<a class="autocomplete-new-btn btn btn-success" href="#" alt="Create New Location"><i class="fa fa-plus"></i></a>'),l.removeBtn=$('<a class="location-selected-remove" href="#" alt="Remove Location" title="Remove Location">&times;</a>'),l.locationRow=a,l.locationTitleSpan=s,l.locationRoomSpan=n,l.locationUrlSpan=o,l.newLocationForm=r,l.createNewLocation=function(e){var t=this;t.removeLocation(),t.newLocationForm.show().children('input[name*="-new_location_title"]').val(e),t.removeBtn.show(),t.addBtn.hide(),t.autocompleteField.val("")},l.removeLocation=function(){var e=this;e.locationTitleSpan.text("").hide(),e.locationRoomSpan.text("").hide(),e.locationUrlSpan.text("").hide(),e.newLocationForm.hide().children("input").val(""),e.dataField.children('option[selected="selected"]').removeAttr("selected").prop("selected",!1),e.removeBtn.hide()},l.setupForm=function(){var e=this;e.locationRow.find("."+e.addBtn.attr("class")).remove(),e.locationRow.find("."+e.removeBtn.attr("class")).remove(),e.locationRow.find("#"+e.autocompleteField.attr("id")).remove(),e.dataField.hide(),e.autocompleteField.insertAfter(e.dataField).show(),$('label[for="'+e.dataField.attr("id")+'"]').attr("for",e.autocompleteField.attr("id")),e.addBtn.insertAfter(e.autocompleteField).hide(),e.removeBtn.insertBefore(e.locationTitleSpan),e.newLocationForm.children('input[name*="-new_location_title"]').val()||e.newLocationForm.hide(),""===e.dataField.val()&&""===$.trim(e.locationTitleSpan.text())&&e.removeBtn.hide(),e.removeBtn.on("click",function(t){t.preventDefault(),e.removeLocation()}),e.addBtn.on("click",function(t){t.preventDefault();var i=e.autocompleteField.val();e.createNewLocation(i)}),e.autocompleteField.on("keydown focus",function(t){var i=e.autocompleteField.siblings(".typeahead.dropdown-menu"),a=i.children("li").length>0&&i.is(":visible")?!0:!1;if(""!==e.autocompleteField.val())if(a||"keydown"!==t.type||13===t.keyCode||188===t.keyCode){if(!a&&"keydown"===t.type&&13===t.keyCode||"keydown"===t.type&&188===t.keyCode){var s=e.autocompleteField.val();return e.createNewLocation(s),e.addBtn.hide(),!1}}else e.addBtn.show();else e.addBtn.hide()}),e.dataField.parents(".cloneable").hasClass("clone")&&(e.dataField.get(0).selectedIndex=e.dataField.children('option[selected="selected"]').val())},l.typeaheadUpdater=function(e){var t=this;t.removeLocation(),t.selection=t.mappedData[e],t.dataField.val(t.selection).children('option[value="'+t.selection+'"]').attr("selected",!0).prop("selected",!0);var i=eventLocations[t.selection];return"None"!==i.title&&""!==i.title&&t.locationTitleSpan.text(i.title).show(),"None"!==i.room&&""!==i.room&&t.locationRoomSpan.text(i.room).show(),"None"!==i.url&&""!==i.url&&t.locationUrlSpan.html('<a href="'+i.url+'">'+i.url+"</a>").show(),t.removeBtn.show(),t.addBtn.hide(),""},l.init()})},eventTagging=function(){var e=$('<input type="text" class="form-control" id="id_event-tags-autocomplete" autocomplete="off" placeholder="Type a tag or phrase..." />'),t=$("#id_event-tags"),i=$('<a class="autocomplete-new-btn btn btn-success" href="#" alt="Create New Tag"><i class="fa fa-plus"></i></a>'),a=$("#event-tags-selected");if(t.length>0){var s=new selectFieldAutocomplete(e,t);s.addBtn=i,s.selectedTagsList=a,s.selectedTagsArray=[],s.createTag=function(e){var t=this,i=$('<a href="#" class="selected-remove" alt="Remove this tag" title="Remove this tag">&times;</a>');if(i.on("click",function(e){e.preventDefault(),t.removeTag($(this).parent("li"))}),!(e.length>0))return!1;var a=$('<li data-tag-name="'+e+'">'+e+"</li>");a.appendTo(t.selectedTagsList).prepend(i),t.addBtn.hide()},s.removeTag=function(e){var t=this;t.selectedTagsList.find(e).remove();var i=e.attr("data-tag-name");t.selectedTagsArray.splice($.inArray(i,t.selectedTagsArray),1)},s.getCleanItemVal=function(e){return $.trim(e.replace(/([^a-zA-Z0-9\s-!$#%&+|:?])/g,""))},s.setupForm=function(){var t=this;if(t.dataField.is(":visible")){var i="";if(t.dataField.val()?i=t.dataField.val():t.dataField.attr("value")&&(i=t.dataField.attr("value")),""!==i){var a=$.grep(i.replace(/(&quot;?)|\"/g,"").split(","),function(e){return""!==e});t.selectedTagsArray=t.selectedTagsArray.concat(a),t.selectedTagsList.children().length<1&&$.each(a,function(e,i){t.createTag(t.getCleanItemVal(i))})}t.dataField.hide(),t.autocompleteField.insertAfter(t.dataField).show(),$('label[for="'+t.dataField.attr("id")+'"]').attr("for",t.autocompleteField.attr("id")),t.addBtn.insertAfter(t.autocompleteField).hide();var s=t.dataField.siblings(".help-block");s.text('Type a word or phrase, then hit the "enter" key or type a comma to add it to your list of tags.')}t.addBtn.on("click",function(e){e.preventDefault();var i=t.getCleanItemVal(t.autocompleteField.val());i.length>0&&t.typeaheadUpdater(i)}),t.autocompleteField.on("keydown focus",function(i){var a=t.autocompleteField.siblings(".typeahead.dropdown-menu"),s=a.children("li").length>0&&a.is(":visible")?!0:!1;if(""!==t.autocompleteField.val())if(s||"keydown"!==i.type||13===i.keyCode||188===i.keyCode){if(!s&&"keydown"===i.type&&13===i.keyCode||"keydown"===i.type&&188===i.keyCode){var n=t.getCleanItemVal(e.val());

return n.length>0&&t.typeaheadUpdater(n),t.addBtn.hide(),!1}}else t.addBtn.show();else t.addBtn.hide()})},s.onFormSubmission=function(){var e=this;e.form.on("submit",function(){if(e.autocompleteField.is(":focus"))return!1;""!==e.autocompleteField.val()&&e.autocompleteField.val()!==e.autocompleteField.attr("placeholder")&&e.selectedTagsArray.push(e.autocompleteField.val());var t=e.selectedTagsArray.toString()+",";e.dataField.val(t).attr("value",t)})},s.setSearchTerms=function(){var e=this;e.searchableTerms=eventTags,$.each(eventTags,function(t,i){e.mappedData[i]=i})},s.typeaheadUpdater=function(e){var t=this;return t.selection=t.mappedData[e],t.selectedTagsArray.push(e),t.autocompleteField.val(""),t.createTag(e),""},s.init()}},cloneableFieldsets=function(){if($(".cloneable").length>0){var e=$(".cloneable").parent(),t=e.children(":first"),i=e.parent().find(".cloner"),a=t.attr("data-form-prefix");i.html('<div>Add another event instance...</div><a class="btn btn-success" href="#" alt="Add another event instance" title="Add another event instance"><i class="fa fa-plus"></i></a>');var s=function(e,t,i){var a=new RegExp("("+t+"-\\d+-)"),s=t+"-"+i+"-";$(e).attr("for")&&$(e).attr("for",$(e).attr("for").replace(a,s)),e.id&&(e.id=e.id.replace(a,s)),e.name&&(e.name=e.name.replace(a,s))},n=function(t){1===$("#id_"+t+"-TOTAL_FORMS").val()||$(".cloneable").length<2?e.find(".remove-instance").addClass("hidden"):e.find(".remove-instance").removeClass("hidden")},o=function(e,t){var i=parseInt($("#id_"+t+"-TOTAL_FORMS").val(),10);return i>1&&($(e).parents(".cloneable").slideUp(300).find('input[id*="-DELETE"]').prop("checked",!0),setTimeout(function(){""===$(e).parents(".cloneable").find('input[id$="-id"]').val()&&$(e).parents(".cloneable").remove();var a=$(".cloneable");$("#id_"+t+"-TOTAL_FORMS").val(a.length);var o=0;for(i=a.length;i>o;o++)for(var r=$(a.get(o)).find("input, textarea, select, label"),l=0;l<r.length;l++)s(r.get(l),t,o);n(t)},300)),!1},r=function(e,i){var a=parseInt($("#id_"+i+"-TOTAL_FORMS").val(),10);if(a<$("#id_"+i+"-MAX_NUM_FORMS").val()){var r=t.clone(!1).get(0);$(r).removeAttr("id").addClass("clone").hide().insertAfter(".cloneable:last").slideDown(300).find("input, textarea, select, label").each(function(){s(this,i,a);var e=$(this);e.is("select")?e.attr("id").indexOf("interval")>=0&&e.find("option:first").attr("selected","selected"):e.val("")}),$(r).find(".remove-instance").click(function(){return o(this,i)}),initiateDatePickers($(r).find(".field-date")),initiateTimePickers($(r).find(".field-time")),eventLocationsSearch($(r).find(".location-dropdown")),$("#id_"+i+"-TOTAL_FORMS").val(a+1),n(i)}else window.alert("Sorry, you can only create a maximum of twelve time/locations.");return!1};n(a),i.click(function(e){return e.preventDefault(),r(this,a)}),$(".remove-instance").click(function(e){return e.preventDefault(),o(this,a)})}},eventContactInfo=function(){var e=$("#add-user-contact-info");"undefined"!=typeof usersFullName&&"undefined"!=typeof usersEmail?e.on("change",function(){var t=$("#id_event-contact_name"),i=$("#id_event-contact_email");usersFullName&&usersEmail&&(e.is(":checked")?(t.val(usersFullName),i.val(usersEmail)):t.val()===usersFullName&&i.val()===usersEmail&&(t.val(""),i.val("")))}):e.parent().hide()};$(document).ready(function(){bulkSelectAll(),bulkActionSubmit(),toggleEventListRecurrences(),toggleModalMergeObject(),calendarOwnershipModal(),toggleModalUserDemote(),initiateDatePickers($(".field-date")),initiateTimePickers($(".field-time")),initiateWysiwyg($('textarea.wysiwyg:not(".disabled-wysiwyg")')),initiateDisabledWysiwyg($("textarea.wysiwyg.disabled-wysiwyg")),initiateReReviewCopy(),userSearchTypeahead(),eventLocationsSearch($("select.location-dropdown")),eventTagging(),cloneableFieldsets(),eventContactInfo()});